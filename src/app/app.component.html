<mat-toolbar color="primary">
  <span>Fantasy Power Rankings Generator</span>
  <span class="spacer"></span>
  <span style="padding-right: 5px">Hello
  <span *ngIf="user">{{user.email}}</span>
  <span *ngIf="!user">Guest</span>
  </span>
  <button class="button submit-button" mat-raised-button color="secondary" (click)="logout()" *ngIf="user">Logout</button>
  <button class="button submit-button" mat-raised-button color="secondary" (click)="openDialog()" *ngIf="!user">Login</button>
</mat-toolbar>
<div class="split left"
     *ngIf="leagueConfigForm !== undefined"
>
<!--  <mat-form-field>-->
<!--    <mat-label>Select League</mat-label>-->
<!--    <mat-select [(value)]="leagueConfig">-->
<!--      <mat-option *ngFor="let config of configsArray" [value]="config">-->
<!--        {{config.leagueName}}-->
<!--      </mat-option>-->
<!--    </mat-select>-->
<!--  </mat-form-field>-->
  <mat-form-field>
    <mat-label>Select League</mat-label>
    <mat-select [(value)]="currentLeague" (selectionChange)="initialize()">
      <mat-option *ngFor="let league of this.user?.leagues" [value]="league">
        {{league}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <br><br>
  <mat-form-field>
    <mat-label>Select Week</mat-label>
    <mat-select [(value)]="currentWeek">
      <mat-option *ngFor="let num of weeks" [value]="num">
        {{num}}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Select Yeah</mat-label>
    <textarea matInput
              type="number"
              cdkTextareaAutosize
              #autosize="cdkTextareaAutosize"
              [(ngModel)]="currentYear"></textarea>
  </mat-form-field>


  <br><br>
  <mat-form-field>
    <mat-label>League Name</mat-label>
    <textarea matInput
              cdkTextareaAutosize
							#autosize="cdkTextareaAutosize"
              cdkAutosizeMinRows="1"
              cdkAutosizeMaxRows="5" [(ngModel)]="leagueConfigForm.leagueId"></textarea>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Rankings Title</mat-label>
    <textarea matInput
              cdkTextareaAutosize
							#autosize="cdkTextareaAutosize"
              cdkAutosizeMinRows="1"
              cdkAutosizeMaxRows="5" [(ngModel)]="leagueConfigForm.rankingsTitle"></textarea>
  </mat-form-field>
  <br>
  <mat-form-field class="introText">
    <mat-label>Rankings Introduction</mat-label>
    <textarea matInput
              cdkTextareaAutosize
              cdkAutosizeMinRows="1"
              cdkAutosizeMaxRows="5" class="introText" style="width: 100%" [(ngModel)]="leagueConfigForm.introduction"></textarea>
  </mat-form-field>
<!--  <ng-container>-->
<!--    <span>Rankings Introduction</span>-->
<!--    <textarea name="text" rows="14" cols="10" wrap="soft" id="rankingIntroduction" [(ngModel)]="leagueConfigForm.introduction"> </textarea>-->
<!--  </ng-container>-->
  <mat-table [dataSource]="leagueConfigForm.teams" class="mat-elevation-z8" cdkDropList [cdkDropListData]="leagueConfigForm.teams"
             (cdkDropListDropped)="drop($event);">
    <ng-container matColumnDef="position" width="5">
      <th mat-header-cell *matHeaderCellDef> Position </th>
      <td mat-cell *matCellDef="let element;index as i;">{{i + 1}}</td>
    </ng-container>

    <ng-container matColumnDef="teamName" width="5">
      <th mat-header-cell *matHeaderCellDef> Team Name </th>
      <td mat-cell *matCellDef="let team">{{team.teamName}}</td>
    </ng-container>

    <ng-container matColumnDef="managerName">
      <th mat-header-cell *matHeaderCellDef> Manager Name </th>
      <td mat-cell *matCellDef="let team"> {{team.managerName}} </td>
    </ng-container>

    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef> Description </th>
      <td mat-cell *matCellDef="let team"> {{team.description}} </td>
    </ng-container>

    <ng-container matColumnDef="wins">
      <th mat-header-cell *matHeaderCellDef> Wins </th>
      <td mat-cell *matCellDef="let team"> {{team.wins}} </td>
    </ng-container>

    <ng-container matColumnDef="losses">
      <th mat-header-cell *matHeaderCellDef> Losses </th>
      <td mat-cell *matCellDef="let team"> {{team.loss}} </td>
    </ng-container>

    <ng-container matColumnDef="ties">
      <th mat-header-cell *matHeaderCellDef> Ties </th>
      <td mat-cell *matCellDef="let team"> {{team.ties}} </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" cdkDragLockAxis="y" cdkDrag [cdkDragData]="row"></tr>
  </mat-table>

<!--    <button class="button submit-button" mat-raised-button color="primary" type="submit" (click)="addTeam()">Add Team</button>-->
    <button class="button submit-button" mat-raised-button color="primary" type="submit" (click)="save()">Save Week</button>
    <button class="button submit-button" mat-raised-button color="primary" type="submit" (click)="regenerateRankings()">Generate Rankings</button>
    <button class="button submit-button" mat-raised-button color="primary" type="submit" (click)="saveAsPreviousWeek()">Save Rankings as Previous Week</button>
</div>

<div class="split right">
  <div id='powerRanking' *ngIf="leagueConfig !== undefined">
    <table id='powerRankingTable'>
      <tr>
        <th colspan='5'><h3 id=rankingTitle>{{leagueConfig.rankingsTitle}}</h3></th>
      </tr>
      <tr id=introduction [hidden]="!leagueConfig.introduction || !(leagueConfig.introduction.length > 0)">
        <th colspan='5' id=introductionRow>
          {{leagueConfig.introduction}}
        </th>
      </tr>
      <tr>
        <td class='center'>
          <b>Rank</b></td>
        <td colspan='2' class='center'><b>Team / Record</b></td>
        <td class='center'><b>Trending</b></td>
        <td class='center'><b>Comments</b></td>
      </tr>
      <ng-container *ngFor="let rankingObject of currentWeekRanking; index as i ">
        <tr class='rank'>
          <td>
            <div class='ranking'> {{i + 1}} </div>
          </td>
          <td class='teamPicture' style='width:25px'></td>
          <td style='width:20%;'>
            <div class='manager-name'>{{rankingObject.teamName}}</div>
            <div class='team-record'>{{rankingObject.managerName}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{getRecord(rankingObject)}}</div>
          </td>
          <td class='center'>
            <div class='delta-div'>
              <div [ngClass]='this.getDeltaSymbolClass (getPreviousWeekPosition(rankingObject.managerName) ? i - getPreviousWeekPosition(rankingObject.managerName) : 0)'></div>
              <div class="delta" [ngClass]='this.getDeltaClass(getPreviousWeekPosition(rankingObject.managerName) ? i - getPreviousWeekPosition(rankingObject.managerName) : 0)'> {{getDeltaString(getPreviousWeekPosition(rankingObject.managerName) ? i - getPreviousWeekPosition(rankingObject.managerName) : 0)}}</div></div>
            <div class='last-weeks-position'>{{getLastWeekPositionString(rankingObject.managerName)}} </div></td>
          <td class='center' style='width: 50%'> {{ rankingObject.description}} </td></tr>
      </ng-container>

    </table>
  </div>
  <div style='height: 5vh;'></div>
  <div style='width: 100%;'>
    <button mat-raised-button color="primary" (click)="generateScreenshot()" class="download-button">Download Rankings Image</button>
  </div>
</div>




